<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Auth Debug</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .log {
        background: #f5f5f5;
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      button {
        padding: 10px 15px;
        margin: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Authentication Debug</h1>

    <div>
      <button onclick="checkStorage()">Check Storage</button>
      <button onclick="clearStorage()">Clear Storage</button>
      <button onclick="simulateLogin()">Simulate Login</button>
    </div>

    <div id="logs"></div>

    <script>
      function log(message) {
        const logsDiv = document.getElementById("logs");
        const logDiv = document.createElement("div");
        logDiv.className = "log";
        logDiv.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
        logsDiv.appendChild(logDiv);
      }

      function checkStorage() {
        log("=== Checking Storage ===");

        // Check localStorage
        const token = localStorage.getItem("auth-token");
        const refreshToken = localStorage.getItem("auth-refresh-token");
        const session = localStorage.getItem("auth-session");

        log(`localStorage token: ${token ? "EXISTS" : "MISSING"}`);
        log(`localStorage refresh: ${refreshToken ? "EXISTS" : "MISSING"}`);
        log(`localStorage session: ${session ? "EXISTS" : "MISSING"}`);

        // Check sessionStorage
        const sessionToken = sessionStorage.getItem("auth-token");
        const sessionRefresh = sessionStorage.getItem("auth-refresh-token");

        log(`sessionStorage token: ${sessionToken ? "EXISTS" : "MISSING"}`);
        log(`sessionStorage refresh: ${sessionRefresh ? "EXISTS" : "MISSING"}`);

        if (session) {
          try {
            const sessionData = JSON.parse(session);
            log(`Session data: ${JSON.stringify(sessionData, null, 2)}`);
          } catch (e) {
            log(`Session parse error: ${e.message}`);
          }
        }
      }

      function clearStorage() {
        localStorage.clear();
        sessionStorage.clear();
        log("All storage cleared");
      }

      function simulateLogin() {
        const token = "mock-token-" + Date.now();
        const sessionData = {
          isAuthenticated: true,
          lastActivity: Date.now(),
          userId: "test-user",
          username: "testuser",
        };

        localStorage.setItem("auth-token", token);
        sessionStorage.setItem("auth-token", token);
        localStorage.setItem("auth-session", JSON.stringify(sessionData));

        log("Login simulated - check storage now");
      }

      // Auto-check on load
      checkStorage();
    </script>
  </body>
</html>
