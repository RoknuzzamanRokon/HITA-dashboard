<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Suppliers Scrolling</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .test-result {
        margin: 10px 0;
        padding: 10px;
        border-radius: 4px;
      }
      .success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      button {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin: 10px 5px;
      }
      button:hover {
        background: #0056b3;
      }
      .demo-suppliers {
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 10px;
        margin: 20px 0;
      }
      .supplier-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px;
        margin: 4px 0;
        background: #f8f9fa;
        border-radius: 4px;
      }
      .supplier-rank {
        background: #007bff;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
      }
      .search-box {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Suppliers Scrolling Test</h1>
      <p>
        Testing the new scrollable suppliers list with search functionality.
      </p>

      <div>
        <button onclick="testBackendSuppliers()">Test Backend Suppliers</button>
        <button onclick="openDashboard()">Open Dashboard</button>
        <button onclick="showDemo()">Show Demo</button>
      </div>

      <div id="results"></div>

      <div class="test-result info">
        <h3>New Features Added:</h3>
        <ul>
          <li>
            ‚úÖ <strong>All Suppliers Display:</strong> Shows all suppliers
            instead of just top 5
          </li>
          <li>
            ‚úÖ <strong>Scrollable List:</strong> Max height with vertical
            scrolling
          </li>
          <li>
            ‚úÖ <strong>Search Filter:</strong> Real-time search to find specific
            suppliers
          </li>
          <li>‚úÖ <strong>Hover Effects:</strong> Better visual feedback</li>
          <li>
            ‚úÖ <strong>Top 3 Indicators:</strong> Yellow dots for top 3
            suppliers
          </li>
          <li>
            ‚úÖ <strong>Responsive Design:</strong> Works on different screen
            sizes
          </li>
        </ul>
      </div>

      <div class="test-result success">
        <h3>Expected Behavior:</h3>
        <ol>
          <li>
            <strong>Dashboard Load:</strong> Should show all 21+ suppliers from
            backend
          </li>
          <li>
            <strong>Scrolling:</strong> List should be scrollable when more than
            ~8 suppliers
          </li>
          <li>
            <strong>Search:</strong> Type in search box to filter suppliers in
            real-time
          </li>
          <li>
            <strong>Ranking:</strong> Numbers show original ranking even when
            filtered
          </li>
          <li>
            <strong>Top 3 Badges:</strong> Yellow dots for ITT, RateHawk, TBO
          </li>
        </ol>
      </div>

      <div id="demo-section" style="display: none">
        <h3>Demo: Scrollable Suppliers List</h3>
        <input
          type="text"
          class="search-box"
          placeholder="Search suppliers..."
          onkeyup="filterDemo(this.value)"
        />
        <div class="demo-suppliers" id="demo-list">
          <!-- Demo content will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <script>
      const BACKEND_URL = "http://127.0.0.1:8002/v1.0";
      const TEST_TOKEN =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1cnNhbXJva28iLCJ1c2VyX2lkIjoiMWEyMDNjY2RhNCIsInJvbGUiOiJzdXBlcl91c2VyIiwiZXhwIjoxNzY0MjM3NDE2LCJ0eXBlIjoiYWNjZXNzIiwiaWF0IjoxNzYyNDM3NDE2fQ.Ri1GAYk-PYv9rrwnYcjNxemUyKOIRbFoI2QtBgmjsOI";

      let allSuppliers = [];

      function addResult(message, type = "info") {
        const resultsDiv = document.getElementById("results");
        const resultDiv = document.createElement("div");
        resultDiv.className = `test-result ${type}`;
        resultDiv.innerHTML = message;
        resultsDiv.appendChild(resultDiv);
      }

      async function testBackendSuppliers() {
        addResult("üîÑ Testing backend suppliers data...", "info");

        try {
          const response = await fetch(
            `${BACKEND_URL}/hotels/check-my-active-suppliers-info`,
            {
              method: "GET",
              headers: {
                Authorization: `Bearer ${TEST_TOKEN}`,
                "Content-Type": "application/json",
              },
              mode: "cors",
            }
          );

          if (response.ok) {
            const data = await response.json();
            const suppliers = data.accessibleSuppliers || [];

            addResult(
              `‚úÖ Backend returned ${suppliers.length} suppliers!`,
              "success"
            );

            // Sort suppliers by hotel count (descending)
            const sortedSuppliers = suppliers.sort(
              (a, b) => b.totalHotels - a.totalHotels
            );

            // Show top 10 suppliers
            let suppliersList = "<strong>Top 10 Suppliers:</strong><br>";
            sortedSuppliers.slice(0, 10).forEach((supplier, index) => {
              suppliersList += `${index + 1}. ${
                supplier.supplierName
              }: ${supplier.totalHotels.toLocaleString()} hotels (${
                supplier.availabilityStatus
              })<br>`;
            });

            if (suppliers.length > 10) {
              suppliersList += `<br>... and ${
                suppliers.length - 10
              } more suppliers`;
            }

            addResult(suppliersList, "info");

            // Store for demo
            allSuppliers = sortedSuppliers;
          } else {
            addResult(`‚ùå Backend failed: HTTP ${response.status}`, "error");
          }
        } catch (error) {
          addResult(`‚ùå Backend error: ${error.message}`, "error");
        }
      }

      function openDashboard() {
        addResult("üöÄ Opening dashboard to test scrolling...", "info");
        window.open("http://localhost:3000/dashboard/hotels", "_blank");
      }

      function showDemo() {
        const demoSection = document.getElementById("demo-section");
        demoSection.style.display = "block";

        // Create demo suppliers if we don't have real data
        if (allSuppliers.length === 0) {
          allSuppliers = [
            {
              supplierName: "itt",
              totalHotels: 1632626,
              availabilityStatus: "active",
            },
            {
              supplierName: "ratehawkhotel",
              totalHotels: 649819,
              availabilityStatus: "active",
            },
            {
              supplierName: "tbohotel",
              totalHotels: 497939,
              availabilityStatus: "active",
            },
            {
              supplierName: "paximumhotel",
              totalHotels: 339662,
              availabilityStatus: "active",
            },
            {
              supplierName: "juniperhotel",
              totalHotels: 328197,
              availabilityStatus: "active",
            },
            {
              supplierName: "letsflyhotel",
              totalHotels: 249802,
              availabilityStatus: "active",
            },
            {
              supplierName: "agoda",
              totalHotels: 241415,
              availabilityStatus: "active",
            },
            {
              supplierName: "grnconnect",
              totalHotels: 229791,
              availabilityStatus: "active",
            },
            {
              supplierName: "ean",
              totalHotels: 220329,
              availabilityStatus: "active",
            },
            {
              supplierName: "innstanttravel",
              totalHotels: 221290,
              availabilityStatus: "active",
            },
            {
              supplierName: "hotelston",
              totalHotels: 487167,
              availabilityStatus: "active",
            },
            {
              supplierName: "hotelbeds",
              totalHotels: 178521,
              availabilityStatus: "active",
            },
            {
              supplierName: "goglobal",
              totalHotels: 137922,
              availabilityStatus: "active",
            },
            {
              supplierName: "dotw",
              totalHotels: 80681,
              availabilityStatus: "active",
            },
            {
              supplierName: "mgholiday",
              totalHotels: 69965,
              availabilityStatus: "active",
            },
          ];
        }

        renderDemo(allSuppliers);
        addResult("üìä Demo loaded with scrollable suppliers list", "success");
      }

      function renderDemo(suppliers) {
        const demoList = document.getElementById("demo-list");
        demoList.innerHTML = "";

        suppliers.forEach((supplier, index) => {
          const item = document.createElement("div");
          item.className = "supplier-item";

          const isTop3 = index < 3;
          const topBadge = isTop3
            ? '<span style="color: #fbbf24; margin-left: 8px;">‚óè</span>'
            : "";

          item.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="supplier-rank">${index + 1}</div>
                        <div>
                            <strong>${
                              supplier.supplierName
                            }</strong>${topBadge}<br>
                            <small>${supplier.totalHotels.toLocaleString()} hotels</small>
                        </div>
                    </div>
                    <div style="background: #10b981; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">
                        ${supplier.availabilityStatus}
                    </div>
                `;

          demoList.appendChild(item);
        });
      }

      function filterDemo(searchTerm) {
        const filtered = allSuppliers.filter((supplier) =>
          supplier.supplierName.toLowerCase().includes(searchTerm.toLowerCase())
        );
        renderDemo(filtered);
      }

      // Auto-test on page load
      window.addEventListener("load", () => {
        setTimeout(testBackendSuppliers, 1000);
      });
    </script>
  </body>
</html>
